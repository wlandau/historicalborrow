<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Usage • historicalborrow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Usage">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">historicalborrow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/methods.html">Methods</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Usage</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wlandau/historicalborrow/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="usage_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wlandau/historicalborrow/blob/main/vignettes/usage.Rmd" class="external-link"><code>vignettes/usage.Rmd</code></a></small>
      <div class="d-none name"><code>usage.Rmd</code></div>
    </div>

    
    
<p>This tutorial shows how to fit historical control-group borrowing models using the <code>historicalborrow</code> package.</p>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p><code>historicalborrow</code> expects data on multiple patients partitioned into studies and groups. Here is a simulated example. There are functions to simulate from the prior predictive distribution of each of the hierarchical, mixture, independent, and pooled models.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wlandau.github.io/historicalborrow/">historicalborrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_sim_independent.html">hb_sim_independent</a></span><span class="op">(</span></span>
<span>  n_continuous <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_study <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_group <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  n_patient <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    outcome <span class="op">=</span> <span class="va">response</span>,</span>
<span>    trial <span class="op">=</span> <span class="va">study</span>,</span>
<span>    arm <span class="op">=</span> <span class="va">group</span>,</span>
<span>    subject <span class="op">=</span> <span class="va">patient</span>,</span>
<span>    factor1 <span class="op">=</span> <span class="va">covariate_study1_continuous1</span>,</span>
<span>    factor2 <span class="op">=</span> <span class="va">covariate_study2_continuous1</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"trial"</span>, <span class="va">trial</span><span class="op">)</span>,</span>
<span>    arm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"arm"</span>, <span class="va">arm</span><span class="op">)</span>,</span>
<span>    subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"subject"</span>, <span class="va">subject</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 400 × 7</span></span></span>
<span><span class="co">#&gt;    trial  arm   subject    factor1 factor2 covariate_study3_continuous1 outcome</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> trial1 arm1  subject1   1.27          0                            0  3.31  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> trial1 arm1  subject2   0.415         0                            0  3.23  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> trial1 arm1  subject3  -<span style="color: #BB0000;">1.54</span>          0                            0 -<span style="color: #BB0000;">3.08</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> trial1 arm1  subject4  -<span style="color: #BB0000;">0.929</span>         0                            0 -<span style="color: #BB0000;">0.623</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> trial1 arm1  subject5  -<span style="color: #BB0000;">0.295</span>         0                            0  2.33  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> trial1 arm1  subject6  -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">77</span>       0                            0  1.12  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> trial1 arm1  subject7   2.40          0                            0  5.88  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> trial1 arm1  subject8   0.764         0                            0  2.69  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> trial1 arm1  subject9  -<span style="color: #BB0000;">0.799</span>         0                            0 -<span style="color: #BB0000;">0.011</span><span style="color: #BB0000; text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> trial1 arm1  subject10 -<span style="color: #BB0000;">1.15</span>          0                            0  0.261 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 390 more rows</span></span></span></code></pre></div>
<p>You as the user will choose a reference level of the <code>study</code> column to indicate which study is the current one (the other are historical). Likewise, you will choose a level of the <code>group</code> column to indicate which group is the control group. To see how <code>historicalborrow</code> assigns numeric indexes to the study and group levels, use <code><a href="../reference/hb_data.html">hb_data()</a></code>. Viewing this output may assist with interpreting the results later on.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">standardized_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_data.html">hb_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">standardized_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 400 × 9</span></span></span>
<span><span class="co">#&gt;    response study_label group_label patient_label study group patient</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    3.31  trial1      arm1        subject1          1     1       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    0.261 trial1      arm1        subject10         1     1       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    1.81  trial1      arm1        subject100        1     1       3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   -<span style="color: #BB0000;">1.21</span>  trial1      arm1        subject11         1     1      13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    0.236 trial1      arm1        subject12         1     1      24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    1.02  trial1      arm1        subject13         1     1      35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    2.72  trial1      arm1        subject14         1     1      46</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    0.485 trial1      arm1        subject15         1     1      57</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    1.83  trial1      arm1        subject16         1     1      68</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    0.357 trial1      arm1        subject17         1     1      79</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 390 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: covariate_factor1 &lt;dbl&gt;, covariate_factor2 &lt;dbl&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span></span>
<span>  <span class="va">standardized_data</span>,</span>
<span>  <span class="va">study</span>,</span>
<span>  <span class="va">study_label</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">group_label</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">study</span>,</span>
<span>    <span class="va">study_label</span>,</span>
<span>    <span class="va">group</span>,</span>
<span>    <span class="va">group_label</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   study study_label group group_label</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 trial1          1 arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2 trial2          1 arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3 trial3          1 arm1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     3 trial3          2 arm2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h2>
<p>The pooled and independent models are benchmarks used to quantify the borrowing strength of the hierarchical and mixture models. To run these benchmark models, run the functions below. Each function returns a data frame with one column per parameter and one row per posterior sample.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_pool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_mcmc_pool.html">hb_mcmc_pool</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  <span class="co"># Can be continuous, categorical, or binary columns:</span></span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Raise these arguments for serious analyses:</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  n_adapt <span class="op">=</span> <span class="fl">2e3</span>,</span>
<span>  n_warmup <span class="op">=</span> <span class="fl">2e3</span>,</span>
<span>  n_iterations <span class="op">=</span> <span class="fl">4e3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mcmc_pool</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16,000 × 10</span></span></span>
<span><span class="co">#&gt;    alpha `beta[1]` `beta[2]`  delta `sigma[1]` `sigma[2]` `sigma[3]` .chain</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0.951      1.31  -<span style="color: #BB0000;">0.174</span>   0.313        1.07      1.02        1.66      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0.822      1.41  -<span style="color: #BB0000;">0.092</span><span style="color: #BB0000; text-decoration: underline;">0</span>  0.049<span style="text-decoration: underline;">1</span>       1.09      0.895       1.72      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 0.908      1.33  -<span style="color: #BB0000;">0.216</span>   0.345        1.05      0.934       1.72      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 0.956      1.43  -<span style="color: #BB0000;">0.118</span>   0.229        1.00      0.944       1.72      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 0.977      1.20  -<span style="color: #BB0000;">0.170</span>   0.572        1.06      0.996       1.70      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 0.983      1.42  -<span style="color: #BB0000;">0.067</span><span style="color: #BB0000; text-decoration: underline;">8</span>  0.230        1.06      1.06        1.71      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1.02       1.38   0.044<span style="text-decoration: underline;">9</span>  0.141        1.14      1.03        1.94      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 0.909      1.34   0.009<span style="text-decoration: underline;">74</span> 0.833        1.11      1.06        1.78      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 0.817      1.30  -<span style="color: #BB0000;">0.070</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.275        1.40      0.967       1.78      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1.03       1.42  -<span style="color: #BB0000;">0.288</span>   0.162        1.33      0.927       1.75      1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 15,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: .iteration &lt;int&gt;, .draw &lt;int&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_independent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_mcmc_independent.html">hb_mcmc_independent</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  <span class="co"># Can be continuous, categorical, or binary columns:</span></span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Raise these arguments for serious analyses:</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  n_adapt <span class="op">=</span> <span class="fl">2e3</span>,</span>
<span>  n_warmup <span class="op">=</span> <span class="fl">2e3</span>,</span>
<span>  n_iterations <span class="op">=</span> <span class="fl">4e3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The hierarchical model works best if the number of historical studies is large. For a small number of historical studies, it may be necessary to choose a value of <code>s_tau</code> to approximate the prior amount of borrowing given a desired precision ratio and supposed residual variance. See the function <code><a href="../reference/hb_s_tau.html">hb_s_tau()</a></code> for an initial value to explore. It is not recommended to entirely rely on <code><a href="../reference/hb_s_tau.html">hb_s_tau()</a></code>, but it does give a benchmark to aid in the thinking.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_hierarchical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_mcmc_hierarchical.html">hb_mcmc_hierarchical</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  <span class="co"># Can be continuous, categorical, or binary columns:</span></span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Raise these arguments for serious analyses:</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  n_adapt <span class="op">=</span> <span class="fl">2e3</span>,</span>
<span>  n_warmup <span class="op">=</span> <span class="fl">2e3</span>,</span>
<span>  n_iterations <span class="op">=</span> <span class="fl">4e3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the mixture model, it is first necessary to use the simple model to get prior mixture components.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hyperparameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_mcmc_mixture_hyperparameters.html">hb_mcmc_mixture_hyperparameters</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">hyperparameters</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   study  study_index m_omega s_omega</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> trial1           1   0.982  0.177 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> trial2           2   0.892  0.097<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> trial3           3   0     30</span></span></code></pre></div>
<p>Then, using just the data from the current study, run the mixture model with the hyperparameters above.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_mixture</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">trial</span> <span class="op">==</span> <span class="st">"trial3"</span><span class="op">)</span></span>
<span><span class="va">mcmc_mixture</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_mcmc_mixture.html">hb_mcmc_mixture</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_mixture</span>, <span class="co"># only analyze current study</span></span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  <span class="co"># Can be continuous, categorical, or binary columns:</span></span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Prior mixture components:</span></span>
<span>  m_omega <span class="op">=</span> <span class="va">hyperparameters</span><span class="op">$</span><span class="va">m_omega</span>,</span>
<span>  s_omega <span class="op">=</span> <span class="va">hyperparameters</span><span class="op">$</span><span class="va">s_omega</span>,</span>
<span>  p_omega <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">hyperparameters</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">hyperparameters</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># Raise these arguments for serious analyses:</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  n_adapt <span class="op">=</span> <span class="fl">2e3</span>,</span>
<span>  n_warmup <span class="op">=</span> <span class="fl">2e3</span>,</span>
<span>  n_iterations <span class="op">=</span> <span class="fl">4e3</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="convergence">Convergence<a class="anchor" aria-label="anchor" href="#convergence"></a>
</h2>
<p>It is important to check convergence diagnostics on each model. The <code><a href="../reference/hb_convergence.html">hb_convergence()</a></code> function returns data frame of summarized convergence diagnostics. <code>max_rhat</code> is the maximum univariate Gelman/Rubin potential scale reduction factor over all the parameters of the model, <code>min_ess_bulk</code> is the minimum bulk effective sample size over the parameters, and <code>min_ess_tail</code> is the minimum tail effective sample size. <code>max_rhat</code> should be below 1.01, and the ESS metrics should both be above 100 times the number of MCMC chains. If any of these conditions are not true, the MCMC did not converge, and it is recommended to try running the model for more saved iterations (and if <code>max_rhat</code> is high, possibly more warmup iterations).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hb_convergence.html">hb_convergence</a></span><span class="op">(</span><span class="va">mcmc_hierarchical</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   max_rhat min_ess_bulk min_ess_tail</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1.07         42.9         11.5</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>Each model can be summarized with the <code><a href="../reference/hb_summary.html">hb_summary()</a></code> function. The output is a table with few rows and many columns.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_hierarchical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_summary.html">hb_summary</a></span><span class="op">(</span></span>
<span>  mcmc <span class="op">=</span> <span class="va">mcmc_hierarchical</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span>,</span>
<span>  eoi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&gt;"</span>, <span class="st">"&lt;"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">summary_hierarchical</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 40</span></span></span>
<span><span class="co">#&gt;   group group_label data_n data_N data_n_study_1 data_n_study_2 data_n_study_3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 arm1           300    300            100            100            100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2 arm2           100    100              0              0            100</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 33 more variables: data_N_study_1 &lt;int&gt;, data_N_study_2 &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   data_N_study_3 &lt;int&gt;, data_mean &lt;dbl&gt;, data_sd &lt;dbl&gt;, data_lower &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   data_upper &lt;dbl&gt;, response_mean &lt;dbl&gt;, response_variance &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   response_sd &lt;dbl&gt;, response_lower &lt;dbl&gt;, response_upper &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   response_mean_mcse &lt;dbl&gt;, response_sd_mcse &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   response_lower_mcse &lt;dbl&gt;, response_upper_mcse &lt;dbl&gt;, diff_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   diff_lower &lt;dbl&gt;, diff_upper &lt;dbl&gt;, diff_mean_mcse &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p><code><a href="../reference/hb_summary.html">hb_summary()</a></code> returns a tidy data frame with one row per group (e.g. treatment arm) and the columns in the following list. Unless otherwise specified, the quantities are calculated at the group level. Some are calculated for the current (non-historical) study only, while others pertain to the combined dataset which includes all historical studies. The mixture model is an exception because the <code>data</code> argument only includes the current study, so other quantities that include historical information will need to borrow from an <code><a href="../reference/hb_summary.html">hb_summary()</a></code> call on one of the other models.</p>
<ul>
<li>
<code>group</code>: group label.</li>
<li>
<code>data_mean</code>: observed mean response specific to the current study.</li>
<li>
<code>data_sd</code>: observed standard deviation of the response specific to the current study.</li>
<li>
<code>data_lower</code>: lower bound of a simple frequentist 95% confidence interval of the observed mean specific to the current study.</li>
<li>
<code>data_upper</code>: upper bound of a simple frequentist 95% confidence interval of the observed mean specific to the current study.</li>
<li>
<code>data_n</code>: number of non-missing observations in the combined dataset with all studies.</li>
<li>
<code>data_N</code>: total number of observations (missing and non-missing) in the combined dataset with all studies.</li>
<li>
<code>data_n_study_*</code>: number of non-missing observations separately for each study. The suffixes of these column names are integer study indexes. Call <code>dplyr::distinct(hb_data(your_data), study, study_label)</code> to see which study labels correspond to these integer indexes. Note: the combined dataset for the mixture model is just the current study. If all the <code>data_n_study_*</code> results across all studies are desired, then call <code><a href="../reference/hb_summary.html">hb_summary()</a></code> on a different model (e.g. pooled).</li>
<li>
<code>data_N_study_*</code>: same as <code>data_n_study_*</code> except both missing and non-missing observations are counted (total number of observations).</li>
<li>
<code>response_mean</code>: Estimated posterior mean of the response from the model specific to the current study. Typically, the raw response is change from baseline, in which case <code>response_mean</code> is estimating change from baseline.</li>
<li>
<code>response_sd</code>: Estimated posterior standard deviation of the mean response from the model specific to the current study.</li>
<li>
<code>response_variance</code>: Estimated posterior variance of the mean response from the model specific to the current study.</li>
<li>
<code>response_lower</code>: Lower bound of a 95% posterior interval on the mean response from the model specific to the current study.</li>
<li>
<code>response_upper</code>: Upper bound of a 95% posterior interval on the mean response from the model specific to the current study.</li>
<li>
<code>response_mean_mcse</code>: Monte Carlo standard error of <code>response_mean</code>.</li>
<li>
<code>response_sd_mcse</code>: Monte Carlo standard error of <code>response_sd</code>.</li>
<li>
<code>response_lower_mcse</code>: Monte Carlo standard error of <code>response_lower</code>.</li>
<li>
<code>response_upper_mcse</code>: Monte Carlo standard error of <code>response_upper</code>.</li>
<li>
<code>diff_mean</code>: Estimated treatment effect from the model specific to the current study.</li>
<li>
<code>diff_lower</code>: Lower bound of a 95% posterior interval on the treatment effect from the model specific to the current study.</li>
<li>
<code>diff_upper</code>: Upper bound of a 95% posterior interval on the treatment effect from the model specific to the current study..</li>
<li>
<code>diff_mean_mcse</code>: Monte Carlo standard error of <code>diff_mean</code>.</li>
<li>
<code>diff_lower_mcse</code>: Monte Carlo standard error of <code>diff_lower</code>.</li>
<li>
<code>diff_upper_mcse</code>: Monte Carlo standard error of <code>diff_upper</code>.</li>
<li>
<code>P(diff &gt; EOI)</code>, <code>P(diff &lt; EOI)</code>: CSF probabilities on the treatment effect specified with the <code>eoi</code> and <code>direction</code> arguments. Specific to the current study.</li>
<li>
<code>effect_mean</code>: Estimated posterior mean of effect size (treatment difference divided by residual standard deviation). Specific to the current study.</li>
<li>
<code>effect_lower</code>: Lower bound of a 95% posterior interval of effect size from the model. Specific to the current study.</li>
<li>
<code>effect_upper</code>: Upper bound of a 95% posterior interval of effect size from the model. Specific to the current study.</li>
<li>
<code>precision_ratio</code>: For the hierarchical model only, a model-based mean of the precision ratio. Specific to the current study.</li>
<li>
<code>precision_ratio_lower</code>: For the hierarchical model only, lower bound of a model-based 95% posterior interval of the precision ratio. Specific to the current study.</li>
<li>
<code>precision_ratio_upper</code>: For the hierarchical model only, upper bound of a model-based 95% posterior interval of the precision ratio. Specific to the current study.</li>
<li>
<code>mix_prop_*</code>: For the mixture model only, posterior mixture proportions of each of the mixture components. The last one is for the current study and the first ones are for the historical studies. The suffixes of these column names are the integer study indexes. Call <code>dplyr::distinct(hb_data(your_data), study, study_label)</code> to see which study labels correspond to these integer indexes.</li>
</ul>
</div>
<div class="section level2">
<h2 id="borrowing-metrics">Borrowing metrics<a class="anchor" aria-label="anchor" href="#borrowing-metrics"></a>
</h2>
<p>The <code><a href="../reference/hb_metrics.html">hb_metrics()</a></code> function shows borrowing metrics like the mean shift ratio and variance shift ratio which require input from benchmark models. The mean shift ratio and variance shift ratio are defined in the methods vignette. Below, we compute these metrics on the hierarchical model.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_pool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_summary.html">hb_summary</a></span><span class="op">(</span></span>
<span>  mcmc <span class="op">=</span> <span class="va">mcmc_pool</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_independent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_summary.html">hb_summary</a></span><span class="op">(</span></span>
<span>  mcmc <span class="op">=</span> <span class="va">mcmc_independent</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/hb_metrics.html">hb_metrics</a></span><span class="op">(</span></span>
<span>  borrow <span class="op">=</span> <span class="va">summary_hierarchical</span>,</span>
<span>  pool <span class="op">=</span> <span class="va">summary_pool</span>,</span>
<span>  independent <span class="op">=</span> <span class="va">summary_independent</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">#&gt;   mean_shift_ratio variance_shift_ratio</span></span>
<span><span class="co">#&gt;              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>            0.477                0.418</span></span></code></pre></div>
<p>Usage with the mixture model is the same.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_mixture</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hb_summary.html">hb_summary</a></span><span class="op">(</span></span>
<span>  mcmc <span class="op">=</span> <span class="va">mcmc_mixture</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data_mixture</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"trial"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="st">"trial3"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="st">"arm1"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"factor1"</span>, <span class="st">"factor2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/hb_metrics.html">hb_metrics</a></span><span class="op">(</span></span>
<span>  borrow <span class="op">=</span> <span class="va">summary_mixture</span>,</span>
<span>  pool <span class="op">=</span> <span class="va">summary_pool</span>,</span>
<span>  independent <span class="op">=</span> <span class="va">summary_independent</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">#&gt;   mean_shift_ratio variance_shift_ratio</span></span>
<span><span class="co">#&gt;              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>            0.726                0.631</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h2>
<p>The <code><a href="../reference/hb_plot_borrow.html">hb_plot_borrow()</a></code> function visualizes the results from a borrowing model (either hierarchical or mixture) against the benchmark models (independent and pooled) to gain intuition about the overall effect of borrowing on estimation.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hb_plot_borrow.html">hb_plot_borrow</a></span><span class="op">(</span></span>
<span>  borrow <span class="op">=</span> <span class="va">summary_hierarchical</span>,</span>
<span>  pool <span class="op">=</span> <span class="va">summary_pool</span>,</span>
<span>  independent <span class="op">=</span> <span class="va">summary_independent</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/borrow1-1.png" width="672"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hb_plot_borrow.html">hb_plot_borrow</a></span><span class="op">(</span></span>
<span>  borrow <span class="op">=</span> <span class="va">summary_mixture</span>,</span>
<span>  pool <span class="op">=</span> <span class="va">summary_pool</span>,</span>
<span>  independent <span class="op">=</span> <span class="va">summary_independent</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/borrow2-1.png" width="672"></p>
<p><code><a href="../reference/hb_plot_group.html">hb_plot_group()</a></code> shows the same information but grouped by the group designations in the data (e.g. treatment arm).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hb_plot_group.html">hb_plot_group</a></span><span class="op">(</span></span>
<span>  borrow <span class="op">=</span> <span class="va">summary_mixture</span>,</span>
<span>  pool <span class="op">=</span> <span class="va">summary_pool</span>,</span>
<span>  independent <span class="op">=</span> <span class="va">summary_independent</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/group-1.png" width="672"></p>
<p>For the hierarchical model, we can plot the marginal posterior of the <code>tau</code> parameter. This should be compared with the prior in practice to understand the influence of prior and data on the posterior.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hb_plot_tau.html">hb_plot_tau</a></span><span class="op">(</span><span class="va">mcmc_hierarchical</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/tau-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by William Michael Landau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
