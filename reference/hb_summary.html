<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Model summary — hb_summary • historicalborrow</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Model summary — hb_summary"><meta property="og:description" content="Summarize a fitted model in a table."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">historicalborrow</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/methods.html">Methods</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/wlandau/historicalborrow/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Model summary</h1>
    <small class="dont-index">Source: <a href="https://github.com/wlandau/historicalborrow/blob/HEAD/R/hb_summary.R" class="external-link"><code>R/hb_summary.R</code></a></small>
    <div class="hidden name"><code>hb_summary.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Summarize a fitted model in a table.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hb_summary</span><span class="op">(</span></span>
<span>  <span class="va">mcmc</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  study <span class="op">=</span> <span class="st">"study"</span>,</span>
<span>  study_reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">study</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  group_reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">group</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^covariate"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  eoi <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  direction <span class="op">=</span> <span class="st">"&lt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mcmc</dt>
<dd><p>A wide data frame of posterior samples returned by
<code><a href="hb_mcmc_hierarchical.html">hb_mcmc_hierarchical()</a></code> or similar MCMC function.</p></dd>


<dt>data</dt>
<dd><p>Tidy data frame with one row per patient,
indicator columns for the response variable,
study, group, and patient,
and covariates. All columns must be atomic vectors
(e.g. not lists). The data for the mixture and simple models
should have just one study,
and the others should have
data from more than one study. The simple model can be used
to get the historical data components of <code>m_omega</code> and <code>s_omega</code>
for the mixture model.</p></dd>


<dt>response</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p></dd>


<dt>study</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p></dd>


<dt>study_reference</dt>
<dd><p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p></dd>


<dt>group</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p></dd>


<dt>group_reference</dt>
<dd><p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p></dd>


<dt>patient</dt>
<dd><p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p></dd>


<dt>covariates</dt>
<dd><p>Character vector of column names
in <code>data</code> with the columns with baseline covariates.
These can be continuous, categorical, or binary.
Regardless, <code>historicalborrow</code> derives the appropriate
model matrix.</p></dd>


<dt>eoi</dt>
<dd><p>Numeric of length at least 1,
vector of effects of interest (EOIs) for critical success factors (CSFs).</p></dd>


<dt>direction</dt>
<dd><p>Character of length <code>length(eoi)</code> indicating how
to compare the treatment effect to each EOI. <code>"&gt;"</code> means
Prob(treatment effect &gt; EOI), and <code>"&lt;"</code> means
Prob(treatment effect &lt; EOI). All elements of <code>direction</code>
must be either <code>"&gt;"</code> or <code>"&lt;"</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A tidy data frame with one row per group (e.g. treatment arm)
and the columns in the following list. Unless otherwise specified,
the quantities are calculated at the group level.
Some are calculated for the current (non-historical) study only,
while others pertain to the combined dataset which includes
all historical studies.
The mixture model is an exception because the <code>data</code> argument
only includes the current study, so other quantities that include
historical information will need to borrow from an <code>hb_summary()</code></p>


<p>call on one of the other models.</p><ul><li><p><code>group</code>: group label.</p></li>
<li><p><code>data_mean</code>: observed mean response specific to the current study.</p></li>
<li><p><code>data_sd</code>: observed standard deviation of the response
specific to the current study.</p></li>
<li><p><code>data_lower</code>: lower bound of a simple frequentist 95% confidence
interval of the observed mean specific to the current study.</p></li>
<li><p><code>data_upper</code>: upper bound of a simple frequentist 95% confidence
interval of the observed mean specific to the current study.</p></li>
<li><p><code>data_n</code>: number of non-missing observations in the combined dataset
with all studies.</p></li>
<li><p><code>data_N</code>: total number of observations (missing and non-missing)
in the combined dataset with all studies.</p></li>
<li><p><code>data_n_study_*</code>: number of non-missing observations separately
for each study.
The suffixes of these column names are integer study indexes.
Call <code>dplyr::distinct(hb_data(your_data), study, study_label)</code>
to see which study labels correspond to these integer indexes.
Note: the combined dataset for the mixture model
is just the current study. If all the <code>data_n_study_*</code> results
across all studies
are desired, then call <code>hb_summary()</code> on a different model (e.g. pooled).</p></li>
<li><p><code>data_N_study_*</code>: same as <code>data_n_study_*</code> except both missing and
non-missing observations are counted (total number of observations).</p></li>
<li><p><code>response_mean</code>: Estimated posterior mean of the response
from the model specific to the current study.
Typically, the raw response is change from baseline,
in which case <code>response_mean</code> is estimating change from baseline.</p></li>
<li><p><code>response_sd</code>: Estimated posterior standard deviation of the mean
response from the model specific to the current study.</p></li>
<li><p><code>response_variance</code>: Estimated posterior variance of the mean
response from the model specific to the current study.</p></li>
<li><p><code>response_lower</code>: Lower bound of a 95% posterior interval on the mean
response from the model specific to the current study.</p></li>
<li><p><code>response_upper</code>: Upper bound of a 95% posterior interval on the mean
response from the model specific to the current study.</p></li>
<li><p><code>response_mean_mcse</code>: Monte Carlo standard error of <code>response_mean</code>.</p></li>
<li><p><code>response_sd_mcse</code>: Monte Carlo standard error of <code>response_sd</code>.</p></li>
<li><p><code>response_lower_mcse</code>: Monte Carlo standard error of <code>response_lower</code>.</p></li>
<li><p><code>response_upper_mcse</code>: Monte Carlo standard error of <code>response_upper</code>.</p></li>
<li><p><code>diff_mean</code>: Estimated treatment effect from the model
specific to the current study.</p></li>
<li><p><code>diff_lower</code>: Lower bound of a 95% posterior interval on the treatment
effect from the model specific to the current study..</p></li>
<li><p><code>diff_upper</code>: Upper bound of a 95% posterior interval on the treatment
effect from the model specific to the current study..</p></li>
<li><p><code>diff_mean_mcse</code>: Monte Carlo standard error of <code>diff_mean</code>.</p></li>
<li><p><code>diff_lower_mcse</code>: Monte Carlo standard error of <code>diff_lower</code>.</p></li>
<li><p><code>diff_upper_mcse</code>: Monte Carlo standard error of <code>diff_upper</code>.</p></li>
<li><p><code>P(diff &gt; EOI)</code>, <code>P(diff &lt; EOI)</code>: CSF probabilities on the
treatment effect specified with the <code>eoi</code> and <code>direction</code>
arguments. Specific to the current study.</p></li>
<li><p><code>effect_mean</code>: Estimated posterior mean of effect size
(treatment difference divided by residual standard deviation).
Specific to the current study.</p></li>
<li><p><code>effect_lower</code>: Lower bound of a 95% posterior interval of effect size
from the model. Specific to the current study.</p></li>
<li><p><code>effect_upper</code>: Upper bound of a 95% posterior interval of effect size
from the model. Specific to the current study.</p></li>
<li><p><code>precision_ratio</code>: For the hierarchical model only,
a model-based mean of the precision ratio. Specific to the current study.</p></li>
<li><p><code>precision_ratio_lower</code>: For the hierarchical model only, lower bound
of a model-based 95% posterior interval of the precision ratio.
Specific to the current study.</p></li>
<li><p><code>precision_ratio_upper</code>: For the hierarchical model only, upper bound
of a model-based 95% posterior interval of the precision ratio.
Specific to the current study.</p></li>
<li><p><code>mix_prop_*</code>: For the mixture model only, posterior mixture proportions
of each of the mixture components. The last one is for the current study
and the first ones are for the historical studies. The suffixes of these
column names are the integer study indexes.
Call <code>dplyr::distinct(hb_data(your_data), study, study_label)</code>
to see which study labels correspond to these integer indexes.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>hb_summary()</code> function post-processes the results from
the model. It accepts MCMC samples of parameters and returns
interpretable group-level posterior summaries such as change
from baseline response and treatment effect. To arrive at these
summaries, <code>hb_summary()</code> computes marginal posteriors of
transformed parameters. The transformations derive patient-level
fitted values from model parameters, then derive group-level
responses as averages of fitted values. We refer to this style
of estimation as "unconditional estimation", as opposed to
"conditional estimation", which takes each group mean to be the
appropriate linear combination of the relevant <code>alpha</code> and <code>delta</code>
parameters, without using <code>beta</code> components or going through fitted
values. If the baseline covariates are balanced across studies,
unconditional and conditional estimation should produce similar
estimates of placebo and treatment effects.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other summary: 
<code><a href="hb_metrics.html">hb_metrics</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"HB_TEST"</span>, unset <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="hb_sim_pool.html">hb_sim_pool</a></span><span class="op">(</span>n_continuous <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"group%s"</span>, <span class="va">data</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mcmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="hb_mcmc_pool.html">hb_mcmc_pool</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  n_chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  n_adapt <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  n_warmup <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>  n_iterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hb_summary</span><span class="op">(</span><span class="va">mcmc</span>, <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by William Michael Landau.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

